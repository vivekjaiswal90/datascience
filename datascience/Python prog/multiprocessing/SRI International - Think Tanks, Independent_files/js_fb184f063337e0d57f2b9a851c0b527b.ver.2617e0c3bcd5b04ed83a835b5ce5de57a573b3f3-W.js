(function(e){function h(a){this.$=a;this.id=a.data("cmap-id");$.extend(this,f[this.id]);this.zoom=this.zoom?parseInt(this.zoom,10):11;this.coords=this.coords||[];this.titles=this.titles||[]}function k(){c=e.google||{};c.maps.visualRefresh=!0;$(".cmap").each(function(){(new h($(this))).init()})}function l(a,d){var b=this;g=g||new c.maps.Geocoder;g.geocode({address:a},function(a,q){if(q!==c.maps.GeocoderStatus.OK)return m(b.$);d(a[0].geometry.location)})}function m(a){e.detail&&e.detail.remove_component?
e.detail.remove_component(a.closest("tr.component")):a.replaceWith('<small style="margin:8px auto;text-align:center;display:block;">Location data is not available for this listing.</small>')}var f=(e.FTB||{}).cmap||{},c,g,n=h.prototype;n.init=function(){var a=this;if("v"===a.type)l(a.laddr,function(b){var d=new c.maps.StreetViewPanorama(a.$[0]);(new c.maps.StreetViewService).getPanoramaByLocation(b,50,function(b,p){if(p!==c.maps.StreetViewStatus.OK)return m(a.$);d.setPano(b.location.pano);d.setVisible(!0)})});
else{var d=c.maps.MapTypeId.ROADMAP;"s"===a.type?d=c.maps.MapTypeId.SATELLITE:"t"===a.type&&(d=c.maps.MapTypeId.TERRAIN);var b=new c.maps.Map(a.$[0],{zoom:a.zoom,mapTypeId:d,panControl:f.is_mobile,streetViewControl:!1,mapTypeControl:!1,draggable:!f.is_mobile});c.maps.event.addListenerOnce(b,"dragend",function(){c.maps.event.trigger(b,"resize")});a.map=b;a.markers=[];$.each(a.coords||[],function(b,d){var e;/^ll:/.test(d)?(e=d.split(":"),a.add_pt(new c.maps.LatLng(e[1],e[2]),a.titles[b])):/^ad:/.test(d)&&
l(d.split(":")[1],function(c){a.add_pt(c,a.titles[b])});if(f.is_mobile)return!1})}};n.add_pt=function(a,d){var b=this,e=new c.maps.Marker({position:a,map:b.map});b.markers.push(e);if(1===b.markers.length){b.map.setCenter(a);b.map.setZoom(+b.zoom);if(!d)return;b.info_win=new c.maps.InfoWindow({maxWidth:270,content:d});c.maps.event.addListenerOnce(b.map,"idle",function(){setTimeout(function(){b.info_win.open(b.map,b.markers[0])},100)})}c.maps.event.addListener(e,"click",function(){b.info_win&&b.info_win.close();
b.info_win=new c.maps.InfoWindow({maxWidth:270,content:d});b.info_win.open(e.map,e)})};$(function(){f.is_mobile?(f.ready=k,e.ftb_mobile.load_map("FTB.cmap.ready")):k()})})(window);
;
